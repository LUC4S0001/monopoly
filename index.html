<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Monopoly - Multijoueur</title>
    <link rel="icon" type="png" href="icon.png">
    <link rel="stylesheet" href="monopoly.css">
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>    
    <div id="ecran-login" class="box">
        <h3>Rentrez votre pseudo :</h3>
        <input type="text" id="mon-pseudo" placeholder="Ton pseudo">
        <br>
        <button onclick="creerPartie()">CrÃ©er une partie</button>
        <div class="separator">OU</div>
        <input type="text" id="id-hote-input" autocomplete="off" placeholder="ID de l'hÃ´te pour rejoindre">
        <button onclick="rejoindrePartie()">Rejoindre une partie</button>
        <div id="msg-erreur-rejoindre" style="color: #ff4d4d; margin-top: 10px; font-weight: bold; display: none; font-size: 14px;"></div>
    </div>

    <div id="ecran-lobby" class="box hidden">
        <h2>Salon d'attente</h2>
        <p>ID de la partie : <br><strong id="affichage-id">...</strong>
           <button id="btn-copier" class="hidden" onclick="copierId()" style="padding: 4px 8px; font-size: 12px; margin-left: 10px; background-color: #4da6ff;">ğŸ“‹ Copier</button>
        </p>
        <p>Joueurs connectÃ©s :</p>
        <ul id="liste-joueurs-lobby" style="list-style: none; padding: 0;"></ul>
        <button id="btn-lancer-partie" class="hidden" onclick="demarrerLaPartie()">Lancer la partie</button>
        <p id="message-attente">En attente de l'hÃ´te...</p>
    </div>

    <div id="ecran-jeu" class="hidden">
        <div id="zone-globale-jeu">
            <div id="plateau" class="plateau">
                <div class="centre-plateau">
                    <h2>Monopoly</h2>
                    <p>Tour de : <strong id="tour-joueur">...</strong></p>

                    <div id="zone-anim-des" class="hidden">
                        <div class="conteneur-des">
                            <div id="de-1" class="de"><div class="face front">1</div><div class="face back">6</div><div class="face right">3</div><div class="face left">4</div><div class="face top">5</div><div class="face bottom">2</div></div>
                            <div id="de-2" class="de"><div class="face front">1</div><div class="face back">6</div><div class="face right">3</div><div class="face left">4</div><div class="face top">5</div><div class="face bottom">2</div></div>
                        </div>
                    </div>

                    <div id="zone-actions-tour" style="margin-bottom: 10px;">
                        <button id="btn-lancer-des" onclick="lancerDesAnime()" disabled>Attente...</button>
                        
                        <div id="zone-achat-terrain" style="display: none; gap: 10px;">
                            <button id="btn-acheter-terrain" onclick="repondreAchatTerrain(true)" style="background-color: #28a745; flex: 1; padding: 12px; font-weight: bold;">Acheter</button>
                            <button id="btn-refuser-terrain" onclick="repondreAchatTerrain(false)" style="background-color: #d9534f; flex: 1; padding: 12px; font-weight: bold;">Passer</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="panneau-droit">
                <h3>Finances</h3>
                <div id="tableau-scores"></div>
                <button id="btn-voir-offres" onclick="ouvrirModalListeOffres()" class="hidden">
                    ğŸ Offres en attente
                    <span id="badge-nb-offres">0</span>
                </button>
                <button id="btn-ouvrir-echange" onclick="ouvrirModalEchange()">ğŸ¤ Proposer un Ã©change</button>

                <h3 style="margin-top: 15px;">Historique</h3>
                <div id="historique">
                    <ul id="liste-historique">
                        <li>La partie commence !</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div id="modal-prison" class="hidden">
        <div class="modal-content">
            <h3>ğŸ‘® Vous Ãªtes en Prison !</h3>
            <p>Comment voulez-vous en sortir ?</p>
            <div class="modal-buttons" style="flex-direction: column; gap: 10px;">
                <button onclick="actionPrison('payer')">Payer 50 â‚¬</button>
                <button id="btn-prison-carte" onclick="actionPrison('carte')">Utiliser une carte</button>
                <button onclick="actionPrison('des')" style="background-color: #f0ad4e; color: #333; font-weight: bold;">Tenter un Double aux dÃ©s</button>
            </div>
        </div>
    </div>

    <div id="modal-infos-terrain" class="hidden">
        <div class="modal-content card-terrain">
            <h3 id="info-nom-terrain">Nom du terrain</h3>
            
            <div id="info-loyers-standard" class="loyers-grid">
                <span class="label-loyer">Loyer terrain nu</span> <span id="loyer-0" class="valeur-loyer">0 â‚¬</span>
                <span class="label-loyer">Avec 1 maison</span> <span id="loyer-1" class="valeur-loyer">0 â‚¬</span>
                <span class="label-loyer">Avec 2 maisons</span> <span id="loyer-2" class="valeur-loyer">0 â‚¬</span>
                <span class="label-loyer">Avec 3 maisons</span> <span id="loyer-3" class="valeur-loyer">0 â‚¬</span>
                <span class="label-loyer">Avec 4 maisons</span> <span id="loyer-4" class="valeur-loyer">0 â‚¬</span>
                <span class="label-loyer">Avec un HÃ´tel</span> <span id="loyer-5" class="valeur-loyer">0 â‚¬</span>
            </div>
            
            <div id="info-loyers-speciaux" class="loyers-grid hidden">
                <p id="texte-loyer-special" style="grid-column: span 2; text-align: center; line-height: 1.5; color: #ccc;"></p>
            </div>

            <div class="infos-prix-bas">
                <div class="prix-item">
                    <span class="icone-prix">Achat</span>
                    <strong id="info-prix-achat">0 â‚¬</strong>
                </div>
                <div class="prix-item" id="bloc-prix-maison">
                    <span class="icone-prix">ğŸ  Maison</span>
                    <strong id="info-prix-maison">0 â‚¬</strong>
                </div>
                <div class="prix-item" id="bloc-prix-hotel">
                    <span class="icone-prix">ğŸ¨ HÃ´tel</span>
                    <strong id="info-prix-hotel">0 â‚¬</strong>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button id="btn-vendre" onclick="actionVendre()" style="background-color: #ff9900; display: none;">Vendre</button>
                <button id="btn-construire" onclick="actionConstruire()" style="background-color: #28a745; display: none;">Construire</button>
                <button onclick="fermerModalInfos()" style="background-color: #d9534f;">Fermer</button>
            </div>
        </div>
    </div>

    <div id="modal-creation-echange" class="hidden">
        <div class="modal-content card-terrain" style="max-width: 600px; width: 90%;">
            <h3 style="border-bottom: 2px solid #9933cc; color: white;">ğŸ¤ Proposer un Ã©change</h3>
            
            <p style="color: white;">Avec qui ? <select id="echange-cible" onchange="majInterfaceEchange()" style="padding: 5px; background: #333; color: white; border: 1px solid #555;"></select></p>

            <div style="display: flex; gap: 20px; margin-top: 15px; text-align: left; color: white;">
                <div style="flex: 1; border: 1px solid #555; padding: 10px; border-radius: 5px; background: rgba(0,0,0,0.3);">
                    <h4 style="color: #4da6ff; margin-top: 0;">Je donne :</h4>
                    <label>ğŸ’° Argent : <input type="number" autocomplete="off" id="echange-donne-argent" min="0" value="0" style="width: 70px;"></label><br><br>
                    <label>ğŸƒ Cartes Prison : <input type="number" autocomplete="off" id="echange-donne-cartes" min="0" value="0" style="width: 50px;"></label><br><br>
                    <p style="margin-bottom: 5px; font-weight: bold; font-size: 14px;">ğŸ  Terrains :</p>
                    <div id="echange-donne-terrains" autocomplete="off" style="max-height: 120px; overflow-y: auto; font-size: 13px;"></div>
                </div>
                
                <div style="flex: 1; border: 1px solid #555; padding: 10px; border-radius: 5px; background: rgba(0,0,0,0.3);">
                    <h4 style="color: #ff4d4d; margin-top: 0;">Je demande :</h4>
                    <label>ğŸ’° Argent : <input type="number" autocomplete="off" id="echange-demande-argent" min="0" value="0" style="width: 70px;"></label><br><br>
                    <label>ğŸƒ Cartes Prison : <input type="number" autocomplete="off" id="echange-demande-cartes" min="0" value="0" style="width: 50px;"></label><br><br>
                    <p style="margin-bottom: 5px; font-weight: bold; font-size: 14px;">ğŸ  Terrains :</p>
                    <div id="echange-demande-terrains" autocomplete="off" style="max-height: 120px; overflow-y: auto; font-size: 13px;"></div>
                </div>
            </div>
            
            <div class="modal-buttons" style="margin-top: 20px;">
                <button onclick="actionEnvoyerEchange()" style="background-color: #28a745;">Envoyer l'offre</button>
                <button onclick="document.getElementById('modal-creation-echange').classList.add('hidden')" style="background-color: #d9534f;">Annuler</button>
            </div>
        </div>
    </div>

    <div id="modal-reponse-echange" class="hidden">
        <div class="modal-content card-terrain" style="max-width: 500px; width: 90%;">
            <h3 style="border-bottom: 2px solid #9933cc; color: white;">ğŸ¤ Proposition d'Ã©change !</h3>
            <p id="texte-reponse-echange" style="line-height: 1.5; font-size: 15px; text-align: left; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 5px; border: 1px solid #444; color: white;"></p>
            <div class="modal-buttons" style="margin-top: 20px;">
                <button onclick="actionRepondreEchange(true)" style="background-color: #28a745;">Accepter</button>
                <button onclick="actionRepondreEchange(false)" style="background-color: #d9534f;">Refuser</button>
            </div>
        </div>
    </div>

    <div id="modal-liste-offres" class="hidden modal-overlay">
        <div class="modal-content card-terrain" style="max-width: 500px; width: 90%;">
            <h3 style="border-bottom: 2px solid #ff9900; color: white; text-align: center;">ğŸ Offres reÃ§ues</h3>
            <div id="conteneur-liste-offres" style="max-height: 300px; overflow-y: auto; margin-top: 15px; display: flex; flex-direction: column; gap: 10px;"></div>
            <div class="modal-buttons" style="margin-top: 20px; justify-content: center;">
                <button onclick="fermerModalListeOffres()" style="background-color: #d9534f;">Fermer</button>
            </div>
        </div>
    </div>

    <script src="monopoly.js"></script>
</body>
</html>